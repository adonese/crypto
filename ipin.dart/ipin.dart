import 'package:simple_rsa/simple_rsa.dart';
import 'package:uuid/uuid.dart';

Future generateIPin({String pin, String key}) async {
  final id = Uuid().v4();
  String ipin = await encryptString(id + pin, key);
  return [ipin, id];
}

//example

final PUBLIC_KEY =
    "MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQBuAGGBgg9nuf6D2c5AIHc8" +
        "vZ6KoVwd0imeFVYbpMdgv4yYi5obtB/VYqLryLsucZLFeko+q1fi871ZzGjFtYXY" +
        "9Hh1Q5e10E5hwN1Tx6nIlIztrh5S9uV4uzAR47k2nng7hh6vuZ33kak2hY940RSL" +
        "H5l9E5cKoUXuQNtrIKTS4kPZ5IOUSxZ5xfWBXWoldhe+Nk7VIxxL97Tk0BjM0fJ3" +
        "8rBwv3++eAZxwZoLNmHx9wF92XKG+26I+gVGKKagyToU/xEjIqlpuZ90zesYdjV+" +
        "u0iQjowgbzt3ASOnvJSpJu/oJ6XrWR3egPoTSx+HyX1dKv9+q7uLl6pXqGVVNs+/" +
        "AgMBAAE=";

Future results =
    generateIPin(pin: "1001", key: PUBLIC_KEY).then((value) => print(value[0]));
